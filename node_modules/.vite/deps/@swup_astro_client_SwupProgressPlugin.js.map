{
  "version": 3,
  "sources": ["../../@swup/progress-plugin/src/ProgressBar.ts", "../../@swup/progress-plugin/src/index.ts"],
  "sourcesContent": ["export default class ProgressBar {\n\tvalue: number = 0;\n\tvisible: boolean = false;\n\thiding: boolean = false;\n\n\tclassName: string = 'progress-bar';\n\tstyleAttr: string = 'data-progressbar-styles data-swup-theme';\n\tanimationDuration: number = 300;\n\tminValue: number = 0.1;\n\tinitialValue: number = 0.25;\n\ttrickleValue: number = 0.03;\n\ttrickleInterval?: number;\n\n\tstyleElement: HTMLStyleElement;\n\tprogressElement: HTMLDivElement;\n\n\tconstructor({\n\t\tclassName,\n\t\tstyleAttr,\n\t\tanimationDuration,\n\t\tminValue,\n\t\tinitialValue,\n\t\ttrickleValue\n\t}: {\n\t\tclassName?: string;\n\t\tstyleAttr?: string;\n\t\tanimationDuration?: number;\n\t\tminValue?: number;\n\t\tinitialValue?: number;\n\t\ttrickleValue?: number;\n\t} = {}) {\n\t\tif (className !== undefined) {\n\t\t\tthis.className = String(className);\n\t\t}\n\t\tif (styleAttr !== undefined) {\n\t\t\tthis.styleAttr = String(styleAttr);\n\t\t}\n\t\tif (animationDuration !== undefined) {\n\t\t\tthis.animationDuration = Number(animationDuration);\n\t\t}\n\t\tif (minValue !== undefined) {\n\t\t\tthis.minValue = Number(minValue);\n\t\t}\n\t\tif (initialValue !== undefined) {\n\t\t\tthis.initialValue = Number(initialValue);\n\t\t}\n\t\tif (trickleValue !== undefined) {\n\t\t\tthis.trickleValue = Number(trickleValue);\n\t\t}\n\n\t\tthis.styleElement = this.createStyleElement();\n\t\tthis.progressElement = this.createProgressElement();\n\t}\n\n\tget defaultStyles(): string {\n\t\treturn `\n\t\t.${this.className} {\n\t\t\tposition: fixed;\n\t\t\tdisplay: block;\n\t\t\ttop: 0;\n\t\t\tleft: 0;\n      width: 100%;\n\t\t\theight: 3px;\n\t\t\tbackground-color: black;\n\t\t\tz-index: 9999;\n\t\t\ttransition:\n\t\t\t\ttransform ${this.animationDuration}ms ease-out,\n\t\t\t\topacity ${this.animationDuration / 2}ms ${this.animationDuration / 2}ms ease-in;\n\t  transform: translate3d(0, 0, 0) scaleX(var(--progress, 0));\n      transform-origin: 0;\n\t\t}\n\t`;\n\t}\n\n\tshow(): void {\n\t\tif (!this.visible) {\n\t\t\tthis.visible = true;\n\t\t\tthis.installStyleElement();\n\t\t\tthis.installProgressElement();\n\t\t\tthis.startTrickling();\n\t\t}\n\t}\n\n\thide(): void {\n\t\tif (this.visible && !this.hiding) {\n\t\t\tthis.hiding = true;\n\t\t\tthis.fadeProgressElement(() => {\n\t\t\t\tthis.uninstallProgressElement();\n\t\t\t\tthis.stopTrickling();\n\t\t\t\tthis.visible = false;\n\t\t\t\tthis.hiding = false;\n\t\t\t});\n\t\t}\n\t}\n\n\tsetValue(value: number): void {\n\t\tthis.value = Math.min(1, Math.max(this.minValue, value));\n\t\tthis.refresh();\n\t}\n\n\tprivate installStyleElement(): void {\n\t\tdocument.head.prepend(this.styleElement);\n\t}\n\n\tprivate installProgressElement(): void {\n\t\tthis.progressElement.style.setProperty('--progress', String(0));\n\t\tthis.progressElement.style.opacity = '1';\n\t\tdocument.body.prepend(this.progressElement);\n\t\tthis.progressElement.scrollTop = 0; // Force reflow to ensure the initial style takes effect\n\t\tthis.setValue(Math.random() * this.initialValue);\n\t}\n\n\tprivate fadeProgressElement(callback: () => void): void {\n\t\tthis.progressElement.style.opacity = '0';\n\t\tsetTimeout(callback, this.animationDuration * 1.5);\n\t}\n\n\tprivate uninstallProgressElement(): void {\n\t\tthis.progressElement.remove();\n\t}\n\n\tprivate startTrickling(): void {\n\t\tif (!this.trickleInterval) {\n\t\t\tthis.trickleInterval = window.setInterval(this.trickle, this.animationDuration);\n\t\t}\n\t}\n\n\tprivate stopTrickling(): void {\n\t\twindow.clearInterval(this.trickleInterval);\n\t\tdelete this.trickleInterval;\n\t}\n\n\tprivate trickle = (): void => {\n\t\tconst advance = Math.random() * this.trickleValue;\n\t\tthis.setValue(this.value + advance);\n\t};\n\n\tprivate refresh(): void {\n\t\trequestAnimationFrame(() => {\n\t\t\tthis.progressElement.style.setProperty('--progress', String(this.value));\n\t\t});\n\t}\n\n\tprivate createStyleElement(): HTMLStyleElement {\n\t\tconst element = document.createElement('style');\n\t\tthis.styleAttr.split(' ').forEach((attr) => element.setAttribute(attr, ''));\n\t\telement.textContent = this.defaultStyles;\n\t\treturn element;\n\t}\n\n\tprivate createProgressElement(): HTMLDivElement {\n\t\tconst element = document.createElement('div');\n\t\telement.className = this.className;\n\t\telement.setAttribute('aria-hidden', 'true');\n\t\treturn element;\n\t}\n}\n", "import Plugin from '@swup/plugin';\nimport ProgressBar from './ProgressBar.js';\n\ntype Options = {\n\tclassName: string;\n\tdelay: number;\n\ttransition: number;\n\tminValue: number;\n\tinitialValue: number;\n\tfinishAnimation: boolean;\n};\n\nexport default class SwupProgressPlugin extends Plugin {\n\tname = 'SwupProgressPlugin';\n\n\tdefaults: Options = {\n\t\tclassName: 'swup-progress-bar',\n\t\tdelay: 300,\n\t\ttransition: 300,\n\t\tminValue: 0.1,\n\t\tinitialValue: 0.25,\n\t\tfinishAnimation: true\n\t};\n\toptions: Options;\n\n\tprogressBar: ProgressBar;\n\tshowProgressBarTimeout?: number;\n\thideProgressBarTimeout?: number;\n\n\tconstructor(options: Partial<Options> = {}) {\n\t\tsuper();\n\t\tthis.options = { ...this.defaults, ...options };\n\t\tconst { className, minValue, initialValue, transition: animationDuration } = this.options;\n\t\tthis.progressBar = new ProgressBar({\n\t\t\tclassName,\n\t\t\tminValue,\n\t\t\tinitialValue,\n\t\t\tanimationDuration\n\t\t});\n\t}\n\n\tmount() {\n\t\tthis.on('visit:start', this.startShowingProgress);\n\t\tthis.on('page:view', this.stopShowingProgress);\n\t}\n\n\tstartShowingProgress() {\n\t\tthis.progressBar.setValue(0);\n\t\tthis.showProgressBarAfterDelay();\n\t}\n\n\tstopShowingProgress() {\n\t\tthis.progressBar.setValue(1);\n\t\tif (this.options.finishAnimation) {\n\t\t\tthis.finishAnimationAndHideProgressBar();\n\t\t} else {\n\t\t\tthis.hideProgressBar();\n\t\t}\n\t}\n\n\tshowProgressBar() {\n\t\tthis.cancelHideProgressBarTimeout();\n\t\tthis.progressBar.show();\n\t}\n\n\tshowProgressBarAfterDelay() {\n\t\tthis.cancelShowProgressBarTimeout();\n\t\tthis.cancelHideProgressBarTimeout();\n\t\tthis.showProgressBarTimeout = window.setTimeout(\n\t\t\tthis.showProgressBar.bind(this),\n\t\t\tthis.options.delay\n\t\t);\n\t}\n\n\thideProgressBar() {\n\t\tthis.cancelShowProgressBarTimeout();\n\t\tthis.progressBar.hide();\n\t}\n\n\tfinishAnimationAndHideProgressBar() {\n\t\tthis.cancelShowProgressBarTimeout();\n\t\tthis.hideProgressBarTimeout = window.setTimeout(\n\t\t\tthis.hideProgressBar.bind(this),\n\t\t\tthis.options.transition\n\t\t);\n\t}\n\n\tcancelShowProgressBarTimeout() {\n\t\twindow.clearTimeout(this.showProgressBarTimeout);\n\t\tdelete this.showProgressBarTimeout;\n\t}\n\n\tcancelHideProgressBarTimeout() {\n\t\twindow.clearTimeout(this.hideProgressBarTimeout);\n\t\tdelete this.hideProgressBarTimeout;\n\t}\n}\n"],
  "mappings": "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",
  "names": ["ProgressBar", "constructor", "className", "styleAttr", "animationDuration", "minValue", "initialValue", "trickleValue", "value", "this", "visible", "hiding", "trickleInterval", "styleElement", "progressElement", "trickle", "advance", "Math", "random", "setValue", "String", "Number", "createStyleElement", "createProgressElement", "defaultStyles", "show", "installStyleElement", "installProgressElement", "startTrickling", "hide", "fadeProgressElement", "uninstallProgressElement", "stopTrickling", "min", "max", "refresh", "document", "head", "prepend", "style", "setProperty", "opacity", "body", "scrollTop", "callback", "setTimeout", "remove", "window", "setInterval", "clearInterval", "requestAnimationFrame", "element", "createElement", "split", "forEach", "attr", "setAttribute", "textContent", "SwupProgressPlugin", "Plugin", "options", "super", "name", "defaults", "delay", "transition", "finishAnimation", "progressBar", "showProgressBarTimeout", "hideProgressBarTimeout", "_extends", "mount", "on", "startShowingProgress", "stopShowingProgress", "showProgressBarAfterDelay", "finishAnimationAndHideProgressBar", "hideProgressBar", "showProgressBar", "cancelHideProgressBarTimeout", "cancelShowProgressBarTimeout", "bind", "clearTimeout"]
}
